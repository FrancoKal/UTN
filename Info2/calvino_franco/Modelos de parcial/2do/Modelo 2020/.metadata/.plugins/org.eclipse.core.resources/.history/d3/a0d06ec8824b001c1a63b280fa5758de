/*
 * adc.c
 *
 *  Created on: 21 nov. 2021
 *      Author: franco
 */

#include "adc.h"

void HabilitarConversion (void)
{
	/*
	 * Que use el modo BURST (hace conversiones automaticamente y ciclicamente) y habilito la secuencia
	 * NOTA: por obligacion del fabricante, esto se debe hacer en la misma linea de codigo
	 */
	ADC->SEQ_CTRL[0] |= (1 << 27) | (1 << 31);
}

void ToggleConversion (void)
{
	//Si el modo BURST y la secuencia estan habilitadas, se deshabilitan, y viceversa
	ADC->SEQ_CTRL[0] ^= (1 << 27) | (1 << 31);
}

void Conversion()
{
	ToggleConversion();

	//Creo un timer para que vence en 1 segundo
	TimerStart(EVENTO_CONVERSION, 1, conversion_handler, SEG);
}

void conversion_handler(void)
{
	Conversion();
}
